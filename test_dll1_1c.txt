// Тестовый скрипт для Dll1.dll
// Выполните в консоли запросов 1С

Процедура ТестПодключения()

    ПутьДЛЛ = "C:\Users\denis\source\repos\Dll1\Debug\Dll1.dll";

    Сообщить("=== ТЕСТ DLL1.DLL ===");
    Сообщить("Путь: " + ПутьДЛЛ);
    Сообщить("");

    // Попытка 1: Через AddIn
    Попытка
        Вендинг1 = Новый("AddIn.Dll1", ПутьДЛЛ);
        Сообщить("✓ AddIn.Dll1 - УСПЕХ");

        // Тест методов
        Если Вендинг1.Connect("192.168.1.100", 5000, 5) Тогда
            Сообщить("  Connect: Успешно");
            Сообщить("  GetStatus: " + Вендинг1.GetStatus());
            Вендинг1.Disconnect();
        Иначе
            Сообщить("  Connect: Не удалось (нормально для теста)");
            Сообщить("  GetStatus без подключения: " + Вендинг1.GetStatus());
        КонецЕсли;

    Исключение
        Сообщить("✗ AddIn.Dll1 - ОШИБКА: " + ОписаниеОшибки());
    КонецПопытки;

    Сообщить("");

    // Попытка 2: Через COM
    Попытка
        Вендинг2 = Новый COMОбъект("Dll1.VendingMachine");
        Сообщить("✓ COM: Dll1.VendingMachine - УСПЕХ");
    Исключение
        Сообщить("✗ COM: Dll1.VendingMachine - ОШИБКА");
    КонецПопытки;

    Попытка
        Вендинг3 = Новый COMОбъект("VendingMachine");
        Сообщить("✓ COM: VendingMachine - УСПЕХ");
    Исключение
        Сообщить("✗ COM: VendingMachine - ОШИБКА");
    КонецПопытки;

    Сообщить("");
    Сообщить("=== ТЕСТ ЗАВЕРШЕН ===");

КонецПроцедуры

// Запуск теста
ТестПодключения();
